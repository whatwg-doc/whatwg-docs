<!DOCTYPE html>
<html>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <!-- lessjs
    <link href="assets/less/site.less" type="text/less" rel="stylesheet" />
	<script src="assets/js/libs/less-1.3.0.min.js"></script>
	-->
    <link href="assets/css/site.css" type="text/css" rel="stylesheet" />
</head>
<body scroll="none">
<div id="screen-wrap">
    <section class="content">
        <article>
            <p class="topicItem"><a href="archives/201304/20130412.md">话题1:关于canvas drawimage()函数的讨论</a></p>
        </article>
    </section>
</div>
<div id="mask"></div>
<script src="assets/js/zepto.min.js"></script>
<script src="assets/js/marked.min.js"></script>
<script>

    $(function () {
        $('article a').click(function (e) {

            var mdUrl = $(this).attr('href'),
                _pWrapper = $(this).parent(),
                _pText = _pWrapper.next()
                ;

            if(!_pText.is('.text')){
                $.ajax({
                    url: mdUrl,
                    type: 'GET',
                    success:function (text) {

                        text = marked(text);

                        var textWrapper = document.createElement('div'),
                            navBar = document.createElement('div'),
                            lexer;

                        textWrapper.classList.add('text')
                        textWrapper.innerHTML = text;

                        _pWrapper.after(textWrapper);
                    },
                    error:function (e, err) {
                        alert('加载md文件失败');
                    }
                });
            }
            else{
                if(_pText.is('.hide')){
                    _pText.siblings('div').addClass('hide');
                    _pText.removeClass('hide');
                }
                else{
                    _pText.addClass('hide');
                }
            }

            e.preventDefault();
        });
    });

</script>
</body>
</html>
